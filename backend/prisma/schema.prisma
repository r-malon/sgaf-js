generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Contrato {
  id       Int    @id @default(autoincrement())
  numero   String @unique
  nome     String
  endereco String
  cpf      String

  afs AF[]

  @@map("Contrato")
}

model AF {
  id          Int      @id @default(autoincrement())
  Contrato_id Int
  principal   Boolean
  numero      String   @unique
  fornecedor  String
  descricao   String?
  data_inicio DateTime
  data_fim    DateTime
  status      Boolean

  contrato Contrato @relation(fields: [Contrato_id], references: [id], onDelete: Restrict)
  items    Item[]

  @@index([Contrato_id])
  @@map("AF")
}

model Local {
  id              Int    @id @default(autoincrement())
  nome            String @unique
  nome_normalized String @unique

  items Item[]

  @@map("Local")
}

model Item {
  id              Int      @id @default(autoincrement())
  AF_id           Int
  Local_id        Int
  descricao       String?
  banda_maxima    Int
  banda_instalada Int
  data_instalacao DateTime
  quantidade      Int
  status          Boolean

  af      AF      @relation(fields: [AF_id], references: [id], onDelete: Restrict)
  local   Local   @relation(fields: [Local_id], references: [id], onDelete: Restrict)
  valores Valor[]

  @@index([AF_id])
  @@index([Local_id])
  @@map("Item")
}

model Valor {
  id          Int       @id @default(autoincrement())
  Item_id     Int
  valor       Int
  data_inicio DateTime
  data_fim    DateTime?

  item Item @relation(fields: [Item_id], references: [id], onDelete: Restrict)

  @@index([Item_id])
  @@map("Valor")
}
