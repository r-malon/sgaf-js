generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Local {
  id              Int    @id @default(autoincrement())
  nome            String @unique
  nome_normalized String @unique

  items Item[]

  @@map("Local")
}

model Contrato {
  id       Int    @id @default(autoincrement())
  numero   String @unique
  nome     String
  endereco String
  cpf      String

  afs AF[]

  @@map("Contrato")
}

model AF {
  id           Int      @id @default(autoincrement())
  principal_id Int?
  Contrato_id  Int
  numero       String   @unique
  fornecedor   String
  descricao    String?
  data_inicio  DateTime
  data_fim     DateTime
  status       Boolean

  contrato Contrato @relation(fields: [Contrato_id], references: [id], onDelete: Restrict)
  items    Item[]

  @@index([principal_id])
  @@index([Contrato_id])
  @@map("AF")
}

model Item {
  id              Int      @id @default(autoincrement())
  Local_id        Int
  AF_id           Int
  descricao       String?
  banda_maxima    Int
  banda_instalada Int
  data_instalacao DateTime
  quantidade      Int
  valor           Int
  total           Int
  status          Boolean

  Item_id Int?  @unique
  prev    Item? @relation("link", fields: [Item_id], references: [id], onDelete: Restrict)
  next    Item? @relation("link")
  local   Local @relation(fields: [Local_id], references: [id], onDelete: Restrict)
  af      AF    @relation(fields: [AF_id], references: [id], onDelete: Restrict)

  @@index([Local_id])
  @@map("Item")
}
